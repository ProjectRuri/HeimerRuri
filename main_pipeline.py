from LOADER.loader import *
from PREPROCESS.preprocess import *
from MODEL.model import *
from OUTPUT.output import *

def main():
    
    # â”€â”€â”€â”€â”€ë°ì´í„° ì¤€ë¹„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    # ì´ë¯¸ í•™ìŠµì´ ì§„í–‰ëœê²½ìš° ë°”ë¡œ ëª¨ë¸ í•™ìŠµìœ¼ë¡œ ì´ë™í•´ë„ë¨

    # ì´ˆê¸° ë°ì´í„° ë¡œë“œ
    origin_data = loader()

    # ì „ì²˜ë¦¬
    preprocessed = preprocess(origin_data)

    # ëª¨ë¸ ì²˜ë¦¬
    fit_model = fit(preprocessed)

    # â”€â”€â”€â”€â”€ëª¨ë¸ í•™ìŠµâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    # ì§€ë„í•™ìŠµìš© ë°ì´í„° ë¡œë“œ

    # ì „ì²˜ë¦¬

    # ì§€ë„í•™ìŠµ ì˜ˆì‹œ 
    #    for X, Y in dataloader:
    #     optimizer.zero_grad()         # ğŸ”¸ ì´ì „ gradientë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”
    #     Y_hat = model(X)              # ğŸ”¸ forward: ì˜ˆì¸¡ê°’ ê³„ì‚°
    #     loss = criterion(Y_hat, Y)    # ğŸ”¸ ì˜ˆì¸¡ vs ì •ë‹µ â†’ ì†ì‹¤
    #     loss.backward()               # ğŸ”¸ ì—­ì „íŒŒ: gradient ê³„ì‚°
    #     optimizer.step()              # ğŸ”¸ gradient ê¸°ë°˜ìœ¼ë¡œ ê°€ì¤‘ì¹˜ ê°±ì‹ 

    # í…ì„œí”Œë¡œìš°ë‚˜ íŒŒì´í† ì¹˜ë¥¼ ì‚¬ìš©í•  ê²½ìš° ì²´í¬í¬ì¸íŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ ì €ì¥í• ê²ƒ
    # ì €ì¥í•  ê²½ìš° ì´ˆí‚¤ ëª¨ë¸ í•™ìŠµì´ ë¶ˆí•„ìš”í•¨